# 区块链

#### 1. 所谓区块链的去中心化
区块链本质上是一个数据库，并且这个数据库是由一个个区块所连接而成的，类似于一个链条。就像下面的图片

![image](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1549172175731&di=c0fde1eb04ffd2f8eced91c475fd60bc&imgtype=0&src=http%3A%2F%2Fww1.sinaimg.cn%2Flarge%2Fe0a6aaa4jw1f6y1s3t7rsj20k50dftb2.jpg)
链条上每一个小圈就是一个区块，每一个区块都保存了上一个区块的hash值（除了创世区块），以此形成联系；每一个区块都保存了一些信息，比如交易记录，一般为多个交易记录。
```
let transactions = [
    {
        fromAddress: 'xxx-bbb',
        toAddress: 'xxx-aaa',
        amount: '100' 
    },
    {
        fromAddress: 'xxx-ddd',
        toAddress: 'xxx-ccc',
        amount: '200' 
    }
]
```
那么所谓的去中心化，类比的是传统的数据库。传统的数据库只能被某一个人或某一个公司访问并读写，而区块链，只要接入了区块链网络，每个人都可以对区块链读写（往链条上增加新的区块，即挖矿）。但是有一个限制，就是**它们是不可变的，一旦一个区块被添加到区块链中，除非让剩余的其余区块失效，否则它是不会再被改变的**。所以关键是数据库的开放问题，一个是对一个人开放，一个是对所有人开放。  
之前我有一个误解，认为区块链的存储也是去中心化的（即分散的），每一个节点不需要存储所有的区块链信息，只需要存储与自己相关的，只要确保每一个节点上每一个区块是合法的，那么通过链条关系和网络，就能查到所有区块的信息，并且这些信息是真实的。  
但是真实情况是，每一个节点不只是存储部分区块，而是一个完整的区块链，从创世块开始到最后一个区块，目前区块链大概有170GB，而且在不断增加。这样每挖到一个矿（产生一个区块），地球上的每一个节点都要同步更新这个区块到链条上去（每一个节点通过p2p协议连接）。  
当然，也有只存储部分区块的节点。
#### 2. 怎么解决区块链被篡改的问题
由于每一个区块都包含了上一个区块的hash，所以如果要改变一个区块（即一笔交易信息），**就要改变每个区块的hash，这需要花费很多时间**，但也并不是不可能。  
所以区块链引入了pow（proof of work，工作量证明）来保证区块链的新增和修改是很难做到的。  
简单说，就是引入了**难度**，产生区块的必要条件是生成一个hash值，如果规定该hash值需要符合一定规则，比如开头要以5个0开头，那么就需要一定的计算量才能生成区块。难度越高，计算的时间越长，生成区块越难。所以挖矿是一个非常耗费计算力和电力的事情。
#### 3. 比特币和挖矿

#### 4. 比特币钱包，私钥，公钥
比特币钱包是一个软件，产生并管理用于交易的账号和密码。其中密码即为私钥，为256位二进制数字组成，总共有2^256种组合，但是一般会转成字符串；私钥经过加工会生成公钥，公钥经过加密生成一个字符串，即为账号，也叫地址。只要私钥确定了，就会产生一个与之对应的地址，并且不可改变。



#### 5. IOTX是在以太坊的发的ERC20 token，现在在上线我们自己的区块链，未来会转换成自己区块链上的token
#### 6. vote 和stake是把token放进只能合约里面
#### 7. 以太坊
以太坊是一个开源的区块链操作系统（平台）， 人们可以基于以太坊开发出各种区块链应用；并且其在该平台发布的货币名称也叫以太坊，发行量仅次于比特币。所以以太坊有两个意思，平台和数字货币。
#### 8. 智能合约(自执行合约)
自动执行，不可撤回。智能合约由代码编写，并由代码自动执行，不能人工干预。执行智能合约需要 'GAS（汽油）'，即以太坊货币（ETH）。
#### 9. 新建智能合约的代码
```js
this.eth = new Eth(window.web3.currentProvider);
const contract = new EthContract(this.eth);

const StackingContract = contract(STAKING_ABI);
this.stakingContract = StackingContract.at(stakingContractAddr);

const tokenContract = new EthContract(this.eth);
this.tokenContract = tokenContract(TOKEN_ABI).at(tokenContractAddr);
```

